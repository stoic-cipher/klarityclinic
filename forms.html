<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Klarity Clinic Form</title>
    <style>
        body {
            margin: 0; padding: 0;
            font-family: 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #1e144f, #320e3b);
            color: #eaeaea;
        }
        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 2rem 1rem;
            text-align: center;
        }
        .logo { max-width: 140px; margin-bottom: 1rem; }
        h1 { font-size: 1.5rem; margin-bottom: 0.5rem; }
        select {
            padding: 0.5rem;
            border-radius: 6px;
            border: none;
            width: 80%;
            max-width: 300px;
            margin-bottom: 1rem;
            font-size: 1rem;
        }
        iframe {
            width: 100%;
            height: 900px;
            border: none;
            border-radius: 8px;
            box-shadow: 0 8px 24px rgba(0,0,0,0.4);
        }
    </style>
</head>
<body>
<div class="container">
    <img src="assets/klarity.png" alt="Klarity Clinic Logo" class="logo" />
    <h1 id="formTitle">Loadingâ€¦</h1>
    <select id="formSelect">
        <option value="chronic-pain">Chronic Pain</option>
        <option value="depression">Depression</option>
        <option value="drug-alcohol">Drug & Alcohol Abuse</option>
        <option value="nad-iv">NAD+/IV Nutrient Therapy</option>
    </select>
    <iframe id="formFrame" scrolling="no" allow="geolocation; microphone; camera; fullscreen"></iframe>
</div>

<script src="https://cdn.jotfor.ms/s/umd/latest/for-form-embed-handler.js"></script>
<script>
    const mapping = {
        "chronic-pain": "https://form.jotform.com/252068621265052",
        "depression":   "https://form.jotform.com/252068838103053",
        "drug-alcohol":"https://form.jotform.com/252068965057062",
        "nad-iv":       "https://form.jotform.com/252068694967071"
    };
    const titles = {
        "chronic-pain": "Chronic Pain Questionnaire",
        "depression":   "Depression Questionnaire",
        "drug-alcohol":"Drug & Alcohol Abuse Questionnaire",
        "nad-iv":       "NAD+/IV Nutrient Therapy Questionnaire"
    };

    const select = document.getElementById('formSelect');
    const frame = document.getElementById('formFrame');
    const title = document.getElementById('formTitle');

    function loadForm(key) {
        if (!mapping[key]) return;
        title.textContent = titles[key];
        frame.src = mapping[key];
        // re-init auto-resize
        window.jotformEmbedHandler(`iframe[id='formFrame']`, "https://form.jotform.com/");
    }

    // On dropdown change
    select.addEventListener('change', e => {
        loadForm(e.target.value);
        history.replaceState(null, "", `forms.html?form=${encodeURIComponent(e.target.value)}`);
    });

    // On page load, read ?form= query param
    const params = new URLSearchParams(location.search);
    const initial = params.get('form') || "chronic-pain";
    select.value = initial;
    loadForm(initial);
</script>
</body>
</html>
